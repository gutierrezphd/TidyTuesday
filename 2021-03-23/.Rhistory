votes %>%
select(-country) %>%
group_by(country_code) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue))
votes %>%
select(-country) %>%
group_by(country_code) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", TRUE,FALSE)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
View
library(correlation)
install.packages("corrlation")
install.packages("correlation")
?correlation
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", TRUE,FALSE)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
group_by(issue) %>%
do(data.frame(Cor=t(cor(.[,3:11], .[,3:11]))))
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
group_by(issue)
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
filter(!is.na(issue)) %>%
names
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
pivot_longer(names_to="country_code", values_from=US:SS)
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
pivot_longer(names_to="country_code", values_from=c(US:SS)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
pivot_longer(names_to="country_code", values_from=c("US":"SS")) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code, issues) %>%
count(vote)
votes %>%
select(-country) %>%
group_by(country_code, issue) %>%
count(vote)
votes %>%
group_by(country, issue) %>%
count(vote)
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
View
install.packages("corrr")
library(corrr)
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
do(correlate(.[,4:Inf]))
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
ncol
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
do(correlate(.[,4:200]))
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
do(correlate(as.matrix(.)[,4:200]))
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
map(., typeof)
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
tibble
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
mutate(across(where(is.list), ~as.numeric)) %>%
do(correlate(.[,4:200]))
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
mutate(across(where(is.list), ~as.numeric)) %>%
.$US
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
mutate(across(where(is.list), ~as.numeric)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
mutate(across(where(is.list), ~as.vector)) %>%
View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>%
mutate(across(where(is.list), ~as.vector)) %>% View
votes %>%
select(-country) %>%
group_by(country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>% View
votes %>%
select(-country) %>%
group_by(rcid, country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>% View
votes %>%
select(-country) %>%
group_by(rcid, short_name, issue, country_code) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>% View
?pivot_wider
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
group_by(rcid, issue, country_code) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes", 1,0)) %>%
pivot_wider(names_from=country_code, values_from=vote) %>%
group_by(issue) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
group_by(issue) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
group_by(issue) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
group_by(issue) %>%
arrange(desc(n)) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
group_by(issue) %>%
arrange(issue) %>% View
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
group_by(issue) %>%
arrange(issue) %>%
pivot_wider(names_from=country_code, values_from=vote)
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue))
votes %>%
select(-country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue)
votes %>%
select(country, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country) %>%
count(n)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n))
939+88
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue)
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Colonialism") %>%
arrange(desc(pct))
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Colonialism") %>%
arrange(desc(pct)) %>%
View
votes$issue %>% unique
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
View
?rworldmap
install.packages('rworldmap',dependencies=TRUE)
library(rworldmap)
vignette('rworldmap')
joinCountryData2Map()
votes %>%
select(-country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
joinCountryData2Map()
?joinCountryData2Map
votes %>%
select(country_code, -short_name) %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct))
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct))
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
rename(country_code = "UN")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
rename("UN" = "country_code")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
rename("UN" = "country_code") %>%
joinCountryData2Map(joinCode="UN")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country_code, vote, issue) %>%
group_by(country_code, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
rename("UN" = "country_code") %>%
joinCountryData2Map(joinCode = "UN", nameJoinColumn = "UN")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct))
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country")
vignette('rworldmap')
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country") %>%
mapCountryData(nameColumnToPlot="pct")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country") %>%
mapCountryData(nameColumnToPlot="pct") %>% is.ggplot()
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Economic development") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country") %>%
mapCountryData(nameColumnToPlot="pct")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Colonialism") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country") %>%
mapCountryData(nameColumnToPlot="pct")
votes %>%
mutate(vote = ifelse(vote=="yes",1,0)) %>%
filter(!is.na(issue)) %>%
count(country, vote, issue) %>%
group_by(country, issue) %>%
mutate(n.country.issue = sum(n)) %>%
filter(vote==1) %>%
rowwise %>%
mutate(pct = n/n.country.issue) %>%
filter(issue=="Human rights") %>%
arrange(desc(pct)) %>%
joinCountryData2Map(joinCode = "NAME", nameJoinColumn = "country") %>%
mapCountryData(nameColumnToPlot="pct")
