group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %>%
View
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% levels(brand)
?fct_reorder
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
select(brand, n.brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n))%$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand))%$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, year)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, 1:10)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
arrange(desc(n.brand)) %>%
filter(!is.na(brand)) %>%
mutate(brand = factor(brand)) %>%
arrange(desc(n.brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
arrange(desc(n.brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>% View
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>% View
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n)) %$% levels(brand)
?fct_reorder
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n, max)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, -n)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(n, brand)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n)) %$% levels(brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_inorder(brand, n)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_inorder(brand)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
?fct_inorder
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_inseq(brand)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = fct_inseq(brand)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand, order=TRUE)) %>%
mutate(brand = fct_reorder(brand, n)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_relevel(brand, n.brand)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
mutate(brand = fct_reorder(brand, n.brand, sum)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, sum)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %$% brand
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(brand, n, fill=factor(year))) +
geom_col() +
coord_polar()
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_col() +
coord_polar() +
facet_wrap(~brand)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_col() +
facet_wrap(~brand)
?facet_wra[]
?facet_wrap
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_col() +
facet_wrap(~brand, scales="free_y")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_line() +
facet_wrap(~brand, scales="free_y")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth() +
facet_wrap(~brand, scales="free_y")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth() +
facet_wrap(~brand, scales=c("free_x","free_y"))
?facet_wrap
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth() +
facet_wrap(~brand, scales="free")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_line() +
facet_wrap(~brand, scales="free")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_line() +
facet_wrap(~brand, scales="free_y")
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_line(aes(color=brand))
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand))
?geom_smooth
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), alpha=0)
?geom_smooth
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), span=.1, alpha=0)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), span=.4, alpha=0)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), span=.8, alpha=0)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), span=2, alpha=0)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=brand), span=.5, alpha=0)
nfl.quality %>%
count(year, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(span=.5, alpha=0) +
facet_wrap(~type)
nfl.quality %>%
count(year, type, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(span=.5, alpha=0) +
facet_wrap(~type)
nfl.quality %>%
count(year, type, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
filter(!is.na) %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(span=.5, alpha=0) +
facet_wrap(~type)
nfl.quality %>%
count(year, type, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
filter(!is.na(type)) %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(span=.5, alpha=0) +
facet_wrap(~type)
nfl.quality %>%
count(year, type, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
filter(!is.na(type)) %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=type), span=.5, alpha=0)
nfl.quality %>%
count(year, type, brand, sort=TRUE) %>%
group_by(brand) %>%
mutate(n.brand = sum(n)) %>%
mutate(brand = factor(brand)) %>%
ungroup %>%
filter(!is.na(type)) %>%
mutate(brand = fct_reorder(brand, n.brand, max)) %>%
ggplot(aes(year, n)) +
geom_smooth(aes(color=type), span=.5, alpha=0) +
expand_limits(y=0)
